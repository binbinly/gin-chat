"use strict";(self["webpackChunkvue_h5_template"]=self["webpackChunkvue_h5_template"]||[]).push([[240],{71240:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var n=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:"个人资料",fixed:"",placeholder:"","left-arrow":""},on:{"click-left":t.onClickLeft}}),e("van-cell",{attrs:{"is-link":"",center:"",title:"头像"},on:{click:t.openAvatar},scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"flex align-center"},[e("van-image",{staticClass:"avatar",staticStyle:{"margin-left":"auto"},attrs:{round:"",src:t._f("formatAvatar")(t.user.avatar)}})],1)]},proxy:!0}])}),e("van-cell",{attrs:{title:"昵称","is-link":"",value:t.user.nickname},on:{click:function(e){t.show=!0}}}),e("van-cell",{attrs:{title:"账号","is-link":"",value:t.user.username}}),e("van-cell",{attrs:{title:"二维码名片","is-link":""},on:{click:t.creatQrCode},scopedSlots:t._u([{key:"default",fn:function(){return[e("span",{staticClass:"iconfont"},[t._v("")])]},proxy:!0}])}),e("van-uploader",{ref:"uploadImage",staticStyle:{display:"none"},attrs:{"prediv-full-image":"","after-read":t.afterRead,accept:"image/*","max-count":1},model:{value:t.avatarFile,callback:function(e){t.avatarFile=e},expression:"avatarFile"}}),e("van-overlay",{attrs:{show:t.show},on:{click:function(e){t.show=!1}}},[e("div",{on:{click:function(t){t.stopPropagation()}}},[e("van-form",{on:{submit:t.onSubmit}},[e("van-field",{attrs:{center:"",clearable:"",label:"昵称",placeholder:"请输入新昵称",rules:[{required:!0}]},scopedSlots:t._u([{key:"button",fn:function(){return[e("van-button",{attrs:{size:"small",type:"primary","native-type":"submit"}},[t._v("修改")])]},proxy:!0}]),model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}})],1)],1)]),e("van-overlay",{attrs:{show:t.showCode},on:{click:function(e){t.showCode=!1}}},[e("div",{staticClass:"wrapper"},[e("div",{staticClass:"bg-white rounded p-4"},[e("div",{staticClass:"flex align-center mb-2 justify-center"},[e("van-image",{staticClass:"avatar",attrs:{src:t._f("formatAvatar")(t.user.avatar)}}),e("div",{staticClass:"pl-1 flex flex-column"},[e("span",[t._v(t._s(t.user.username?t.user.username:t.user.nickname))])])],1),e("div",{staticClass:"flex flex-column align-center justify-center"},[e("div",{ref:"qrCodeUrl",staticClass:"qrcode mb-2"}),e("span",{staticClass:"text-light-muted"},[t._v("扫一扫上边二维码图案，加我的仿微信")])])])])])],1)},r=[],s=(a(58479),a(39146)),i=a(71568),o=a(83874),c=a.n(o),u=a(35485),l=a(20629),f=a(2718),d={mixins:[i.Z],data(){return{qrcode:!1,avatarFile:[],show:!1,showCode:!1,nickname:""}},computed:{...(0,l.rn)({user:t=>t.user.user}),confirmTitle(){return"username"==this.confirmType?"修改账号":"修改昵称"},placeholder(){return"username"==this.confirmType?"输入账号":"输入昵称"}},methods:{creatQrCode(){this.showCode=!0,this.qrcode||(new(c())(this.$refs.qrCodeUrl,{text:JSON.stringify({id:this.user.id,type:1}),width:240,height:240,colorDark:"#000000",colorLight:"#ffffff",correctLevel:c().CorrectLevel.H}),this.qrcode=!0)},afterRead(t){t.status="uploading",t.message="上传中...",(0,f.cT)(t.file).then((e=>{t.status="done",(0,u.f)({avatar:e.path}).then((()=>{this.user.avatar=e.url,s.Z.success("修改头像成功"),this.$store.commit("updateUser",{k:"avatar",v:e.url})}))})).catch((()=>{t.status="failed",t.message="上传失败"}))},openAvatar(){this.$refs.uploadImage.chooseFile()},onSubmit(){(0,u.f)({nickname:this.nickname}).then((()=>{this.$store.commit("updateUser",{k:"nickname",v:this.nickname}),this.show=!1,this.user.nickname=this.nickname,s.Z.success("修改成功")}))}}},h=d,m=a(1001),v=(0,m.Z)(h,n,r,!1,null,null,null),p=v.exports},2718:function(t,e,a){a.d(e,{S0:function(){return c},YD:function(){return s},Zr:function(){return o},cT:function(){return u},qz:function(){return i},x4:function(){return r}});var n=a(7705);function r(t){return n.Z.post(n.Z.Login,t,!1)}function s(t){return n.Z.post(n.Z.Reg,t,!1)}function i(t){return n.Z.post(n.Z.SearchUser,t)}function o(){return n.Z.get(n.Z.EmoticonCat)}function c(t){return n.Z.get(n.Z.Emoticon,{cat:t},!0)}function u(t){return n.Z.upload(n.Z.Upload,{file:t}).then((t=>t)).catch((t=>{reject(t)}))}},35485:function(t,e,a){a.d(e,{K:function(){return s},f:function(){return r}});var n=a(7705);function r(t){return n.Z.post(n.Z.User.Edit,t)}function s(){return n.Z.get(n.Z.Logout)}},71568:function(t,e,a){a(58479);var n=a(39146),r=a(76927);e["Z"]={created(){let t=(0,r.cF)("token");if(!t)return this.$router.push({path:"/login"})},methods:{onClickLeft(){this.$router.back()},push(t,e){this.$router.push({path:t,params:e})},draw(){(0,n.Z)("待开发")},backToast(t="非法参数"){this.toast(t),setTimeout((()=>{this.$router.back()}),500)},toast(t="非法参数"){(0,n.Z)({title:t,position:"bottom"})}}}}}]);