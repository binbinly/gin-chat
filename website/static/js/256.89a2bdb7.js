"use strict";(self["webpackChunkvue_h5_template"]=self["webpackChunkvue_h5_template"]||[]).push([[256],{62961:function(t,e,s){s.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t._self._c;return t.status?e("div",{staticStyle:{"z-index":"9999",overflow:"hidden"}},[t.mask?e("div",{staticClass:"position-fixed top-0 left-0 right-0 bottom-0 z-index",style:t.getMaskColor,on:{click:t.hide}}):t._e(),e("div",{ref:"popup",staticClass:"position-fixed z-index",class:t.getBodyClass,style:t.getBodyStyle},[t._t("default")],2)]):t._e()},i=[],a={props:{maskColor:{type:Boolean,default:!1},mask:{type:Boolean,default:!0},center:{type:Boolean,default:!1},bottom:{type:Boolean,default:!1},bodyWidth:{type:Number,default:0},bodyHeight:{type:Number,default:0},bodyBgColor:{type:String,default:"bg-dark"},transformOrigin:{type:String,default:"left top"},tabbarHeight:{type:Number,default:0}},data(){return{status:!1,x:-1,y:1,maxX:240,maxY:500}},mounted(){},computed:{getMaskColor(){let t=this.maskColor?.5:0;return`background-color: rgba(0,0,0,${t});`},getBodyClass(){if(this.center)return"left-0 right-0 bottom-0 top-0 flex align-center justify-center";let t=this.bottom?"left-0 right-0 bottom-0":"rounded border";return`${this.bodyBgColor} ${t}`},getBodyStyle(){let t=this.x>-1?`left:${this.x}px;`:"",e=this.y>-1?`top:${this.y}px;`:"";return t+e}},methods:{show(t=-1,e=-1){this.status||(this.x=t>this.maxX?this.maxX:t,this.y=e>this.maxY?this.maxY:e,this.status=!0)},hide(){this.$emit("hide"),this.status=!1}}},o=a,r=s(1001),l=(0,r.Z)(o,n,i,!1,null,"0b2de364",null),u=l.exports},76968:function(t,e,s){s.d(e,{Z:function(){return c}});var n=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{fixed:"",placeholder:""},scopedSlots:t._u([t.title?{key:"left",fn:function(){return[e("span",{staticClass:"font"},[t._v(t._s(t.getTitle))])]},proxy:!0}:null,{key:"right",fn:function(){return[e("van-icon",{staticClass:"mr-1",attrs:{name:"search",size:"24"},on:{click:t.search}}),e("van-popover",{attrs:{offset:[-50,20],placement:"bottom",theme:"dark",trigger:"click",actions:t.menus},on:{select:t.onSelect},scopedSlots:t._u([{key:"reference",fn:function(){return[e("van-icon",{attrs:{name:"add-o",size:"22"}})]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})]},proxy:!0}],null,!0)})],1)},i=[],a=(s(58479),s(39146)),o={props:{title:{type:[String,Boolean],default:!1},unread:{type:[Number,String],default:0}},data(){return{showPopover:!1,menus:[{text:"发起群聊",className:"group",icon:"chat-o",path:"/contact_list",query:{type:"createGroup"}},{text:"添加好友",pclassName:"add_user",icon:"friends-o",path:"/search",query:{}},{text:"扫一扫",className:"scan",icon:"scan"},{text:"收付款",className:"pay",icon:"gold-coin-o"},{text:"帮助与反馈",className:"about",icon:"question-o"}]}},computed:{getTitle(){let t=this.unread>0?"（"+this.unread+"）":"";return this.title+t}},methods:{search(){this.$router.push({path:"/search"})},onSelect(t){t.path?this.$router.push({path:t.path,query:t.query}):(0,a.Z)("待开发")}}},r=o,l=s(1001),u=(0,l.Z)(r,n,i,!1,null,null,null),c=u.exports},19256:function(t,e,s){s.r(e),s.d(e,{default:function(){return v}});var n=function(){var t=this,e=t._self._c;return e("div",[e("nav-bar",{attrs:{title:"仿微信",unread:t.totalunread}}),t.chat&&t.chat.isOnline?t._e():e("div",{staticClass:"bg-danger left-0 right-0 flex align-center justify-between"},[e("span",{staticClass:"text-white p-1",on:{click:function(e){return t.chat.reconnectConfirm()}}},[t._v("当前处于离线状态，点击重新连接")])]),t._l(t.list,(function(s,n){return[s.is_top?e("msg-item",{attrs:{item:s,index:n},on:{long:t.long}}):t._e()]})),t._l(t.list,(function(s,n){return[s.is_top?t._e():e("msg-item",{attrs:{item:s,index:n},on:{long:t.long}})]})),e("free-popup",{ref:"extend",attrs:{bodyWidth:200,bodyHeight:t.getMenusHeight}},[e("div",{staticClass:"flex flex-column text-white p-1",staticStyle:{width:"90px"},style:t.getMenusStyle},t._l(t.menus,(function(s,n){return e("div",{key:n,staticClass:"flex-1 flex align-center justify-center",staticStyle:{padding:"5px"},on:{click:function(e){return t.clickEvent(s.event)}}},[e("span",{staticClass:"font-sm"},[t._v(t._s(s.name))])])})),0)])],2)},i=[],a=s(62961),o=s(76968),r=function(){var t=this,e=t._self._c;return e("div",{class:t.item.is_top?"bg-light":"bg-white"},[e("van-cell",{directives:[{name:"longpress",rawName:"v-longpress",value:t.long,expression:"long"}],attrs:{center:""},on:{click:t.onClick},scopedSlots:t._u([{key:"icon",fn:function(){return[e("van-badge",{attrs:{content:t.item.unread||""}},[e("van-image",{attrs:{round:"",width:"40",height:"40",src:t.getAvatar}})],1)]},proxy:!0},{key:"title",fn:function(){return[e("div",{staticClass:"flex flex-column pl-1"},[e("span",{staticClass:"font"},[t._v(t._s(t.item.name))]),e("span",{staticClass:"text-inline font-small text-light-muted",staticStyle:{width:"220px"}},[t._v(t._s(t.item.content))])])]},proxy:!0},{key:"default",fn:function(){return[e("span",{staticClass:"text-light-muted font-small"},[t._v(t._s(t._f("formatTime")(t.item.t)))])]},proxy:!0}])})],1)},l=[],u=s(20629),c={props:{item:Object,index:Number},computed:{...(0,u.rn)({chat:t=>t.user.chat}),getAvatar(){return this.item.avatar?this.item.avatar:2==this.item.chat_type?s(38002):s(81051)}},methods:{onClick(){this.$router.push({path:"/chat",query:{id:this.item.id,type:this.item.chat_type}}),this.chat.readChatItem(this.item.id,this.item.chat_type)},long(t){const e=t.changedTouches[0].pageX,s=t.changedTouches[0].pageY;this.$emit("long",{x:e,y:s,index:this.index})}}},h=c,p=s(1001),d=(0,p.Z)(h,r,l,!1,null,null,null),m=d.exports,f=s(71568),g={mixins:[f.Z],components:{FreePopup:a.Z,NavBar:o.Z,MsgItem:m},data(){return{propIndex:-1,menus:[{name:"设为置顶",event:"setTop"},{name:"删除该聊天",event:"delChat"}]}},mounted(){},computed:{...(0,u.rn)({list:t=>t.user.chatList,totalunread:t=>t.user.totalunread,chat:t=>t.user.chat}),getMenusHeight(){let t=100;return this.menus.length*t},getMenusStyle(){return`height: ${this.getMenusHeight}rpx;`}},methods:{long({x:t,y:e,index:s}){this.propIndex=s;let n=this.list[s];this.menus[0].name=n.is_top?"取消置顶":"设为置顶",this.$refs.extend.show(t,e)},clickEvent(t){switch(t){case"setTop":this.setTop();break;case"delChat":this.delChat();break}this.$refs.extend.hide()},delChat(){let t=this.list[this.propIndex];this.chat.removeChatItem(t.id,t.chat_type)},setTop(){let t=this.list[this.propIndex];t.is_top=!t.is_top}}},x=g,y=(0,p.Z)(x,n,i,!1,null,null,null),v=y.exports},71568:function(t,e,s){s(58479);var n=s(39146),i=s(76927);e["Z"]={created(){let t=(0,i.cF)("token");if(!t)return this.$router.push({path:"/login"})},methods:{onClickLeft(){this.$router.back()},push(t,e){this.$router.push({path:t,params:e})},draw(){(0,n.Z)("待开发")},backToast(t="非法参数"){this.toast(t),setTimeout((()=>{this.$router.back()}),500)},toast(t="非法参数"){(0,n.Z)({title:t,position:"bottom"})}}}}}]);